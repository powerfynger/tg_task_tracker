# Описание проекта

Этот проект представляет собой трекер задач с возможностью указания, какие задачи были затронуты сегодня, а также планирования задач на завтра. Бэкенд написан на Flask, а единственным интерфейсом на данный момент является бот в Telegram.

## Основные возможности:

- Создание, редактирование и удаление задач.
- Учет дней, потраченных на выполнение задач.
- Планирование задач на завтра.
- Возможность отметить задачи, выполненные сегодня.
- Ведение списка пользователей.

## Структура проекта

Проект состоит из двух основных компонентов:

**1. Бэкенд на Flask**

Бэкенд реализован с использованием Flask и предоставляет API для управления задачами и пользователями. Он включает следующие основные компоненты:

- **Основные модули и их функции:**
    - Blueprints:
        - `tasks_bp`: обработка запросов, связанных с задачами (создание, получение, обновление, удаление задач).
        - `users_bp`: обработка запросов, связанных с пользователями (создание, получение, обновление, удаление пользователей).
        - `timers_bp`: обработка запросов, связанных с таймерами пользователей (создание, получение, обновление статуса, удаление).

- **Маршруты (Endpoints):**
    - `/users` [GET]: получение всех пользователей.
    - `/user` [POST]: создание нового пользователя.
    - `/user` [GET]: получение пользователя по соотвествию переданному полю.
    - `/user/<int:user_id>` [PUT]: обновление информации о пользователе.
    - `/user/<int:user_id>` [DELETE]: удаление пользователя.
    - `/tasks` [GET]: получение всех задач.
    - `/tasks/<int:tg_id>` [GET]: получение задач пользователя по его Telegram ID.
    - `/task` [POST]: создание новой задачи.
    - `/task/<int:task_id>` [GET]: получение задачи по ID.
    - `/task/<int:task_id>` [PUT]: обновление задачи.
    - `/task/<int:task_id>` [DELETE]: удаление задачи.
    - `/timers` [GET]: получение всех доступных таймеров: название, длительность периодов.
    - `/timer` [GET]: получение таймера пользователя по TG id.
    - `/timer` [PUT]: обновление статуса таймера.
    - `/timer` [DELETE]: удаление таймера.
- **Модели данных:**
    - `User`: модель пользователя с атрибутами `id`, `username` (не используется), `tg_id`, `last_time_interaction` (не используется), `tasks_completed`.
    - `Task`: модель задачи с атрибутами `id`, `title`, `description`, `days_spent`, `deadline`, `priority`, `planned_for_tomorrow`, `user_id`.
    - `Timer`: модель таймера с атрибутами `id`, `type_id`, `time_start` (не используется), `time_end`, `state`, `user_id`.
    Также напрямую в коде заданы названия и длительности периодов для различных таймеров. 
- **Задачи по расписанию:**
    - Очистка запланированных задач всех пользователей каждые сутки
    - Проверка таймеров на истечение и необходимость смены состояния

**2. Телеграм-бот**

Телеграм-бот предоставляет интерфейс для взаимодействия с пользователем. Он реализован с использованием библиотеки `python-telegram-bot`.

- **Основные функции бота:**
    - **Команды:**
        - `/start`: регистрация пользователя и приветственное сообщение.
        - `/help`: отображение списка доступных команд.
        - `/tasks`: просмотр всех задач пользователя.
        - `/create`: создание новой задачи.
        - `/delete`: удаление задачи.
        - `/edit`: редактирование задачи.
        - `/plan`: планирование задач на завтра.
        - `/daily`: просмотр задач, запланированных на сегодня.
        - `/subscription`: изменение статуса подписки на ежевечерний опрос.
        - `/timer`: запуск таймера эффективной работы.
- **Задачи по расписанию:**
    - Отправка опроса о задачах, которыми пользователи сегодня занимались, для сбора статистики и генерации персональных отчётов (в разработке)
    - Каждые 30 секунд запрос на сервер о текущих таймерах и их проверка на необходимость смены состояния. Данный функционал должен быть изначально вынесен на сторону сервера, однако на данном этапе было решено оставить его напрямую в боте.  

## Особенности функционала
**1. Доступные таймеры**
**Классические техники:**
- **Pomodoro:** 25 минут работы / 5 минут отдыха (4 цикла), затем долгий перерыв 15-20 минут.
- **Техника 52/17 (aka NeoPomodoro):** 52 минуты работы / 17 минут отдыха. Считается более эффективной для некоторых людей, чем Pomodoro.

**Другие варианты:**

- **90/30:** 90 минут работы / 30 минут отдыха. Подходит для задач, требующих глубокой концентрации.
- **45/15:** 45 минут работы / 15 минут отдыха. Более короткие интервалы, могут помочь тем, кому сложно концентрироваться длительное время.
**2. Рассылка**
- Каждый вечер в 23:00 МСК подписанынм пользователям приходит уведомление с опросом о тех задачах, которыми они сегодня занимались. В будущем эта информация будет использована для генерации статистики.

## Запуск проекта

**1. Установка зависимостей**

Установите необходимые зависимости с помощью pip:

```bash
pip install -r requirements.txt
```

**2. Настройка**

Создайте файл конфигурации `.env` и добавьте необходимые переменные окружения:

```plaintext
API_KEY_BACKEND=your_api_key
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
```

**3. Запуск сервера и бота**

```bash
python run.py
```

